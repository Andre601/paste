{"version":3,"sources":["../../src/js/editor.js"],"names":["pasteNum","pasteEditors","DateTime","luxon","ws","connectWebSocket","WebSocket","document","location","host","addEventListener","msg","split","data","indexOf","id","Number","substring","hl","code","getElementById","parentElement","hasAttribute","setAttribute","innerHTML","prettyOffset","i","isNeg","input","Math","abs","hour","floor","frac","mins","hs","toString","padStart","ms","pre","getAbsoluteExpiry","makeDate","date","time","tz","dateValue","value","timeValue","tzValue","tzNum","prettyTz","dateString","finalDate","fromISO","getRelativeExpiry","yearsElem","daysElem","hoursElem","minutesElem","years","days","hours","minutes","isNaN","local","plus","getExpiry","expires","setTimezone","tzSelect","offset","undefined","children","forEach","e","removeAttribute","createUpload","getLanguage","parent","lang","querySelector","files","Object","values","editor","editorRoot","file","getCode","push","highlight","readyState","OPEN","createElement","wrapper","override","name","type","send","newPre","newCode","appendChild","setUpEditor","el","style","height","Editor","hidden","insertAdjacentElement","nameInput","langInput","updateLanguage","getSuffixFromName","pop","suffix","toDelete","removeFile","addFile","base","clone","cloneNode","classList","remove","getElementsByTagName","ta","updateButtons","num","keys","length","enabled","getElementsByName","button","disabled","createEditors","querySelectorAll","JSON","stringify","target","expiry","expiresInput","inputsRequired","req","rel","add","expirationDate","dataset","year","month","day","minute"],"mappings":"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","sourcesContent":["/* global Editor:false, luxon:false */\n\nlet pasteNum = 0;\nconst pasteEditors = {};\n\n(function() {\n  const DateTime = luxon.DateTime;\n\n  let ws;\n  connectWebSocket();\n\n  function connectWebSocket() {\n    ws = new WebSocket(`wss://${document.location.host}/highlight/`);\n    ws.addEventListener('close', connectWebSocket);\n    ws.addEventListener('error', connectWebSocket);\n    ws.addEventListener('message', msg => {\n      // find the first newline and split the data on it\n      const split = msg.data.indexOf('\\n');\n      // the left side will be the paste number\n      const id = Number(msg.data.substring(0, split));\n      // the right side will be the highlighted content\n      const hl = msg.data.substring(split + 1);\n\n      // get the code element of the given editor\n      const code = document.getElementById(`highlight-${id}`);\n      if (code === null) {\n        return;\n      }\n      // add the lang attribute to the <pre> if necessary\n      if (!code.parentElement.hasAttribute('lang')) {\n        code.parentElement.setAttribute('lang', '');\n      }\n      // update the inner html of the <code> element\n      code.innerHTML = hl;\n    });\n  }\n\n  /**\n   * Formats a UTC offset into \"+04:30\" format from a decimal like 4.5.\n   *\n   * @param {Number} i Decimal representing UTC offset\n   * @returns {String} Formatted String\n   */\n  function prettyOffset(i) {\n    // check if the offset is negative for formatting later. all the math will be done as if it were\n    // positive\n    const isNeg = i < 0;\n\n    const input = Math.abs(i);\n\n    // get the hour component by stripping off the fraction\n    const hour = Math.floor(input);\n\n    // subtract the hour component to get the fraction\n    const frac = input - hour;\n\n    const mins = 60 * frac;\n\n    // pad with leading zeroes\n    const hs = hour.toString().padStart(2, '0');\n    const ms = mins.toString().padStart(2, '0');\n\n    const pre = isNeg ? '-' : '+';\n    return `${pre}${hs}:${ms}`;\n  }\n\n  /**\n   * @param {boolean} makeDate Whether to turn the ISO String into a Date\n   * @returns {null | DateTime | String} The absolute expiry date set by the user, if set, otherwise\n   * null. Returns an ISO string if makeDate is false, a DateTime if true.\n   */\n  function getAbsoluteExpiry(makeDate) {\n    const date = document.getElementById('absolute-date');\n    const time = document.getElementById('absolute-time');\n    const tz = document.getElementById('absolute-timezone');\n\n    if (date === null || time === null || tz === null) {\n      return null;\n    }\n\n    const dateValue = date.value;\n    const timeValue = time.value;\n    const tzValue = tz.value;\n\n    if (!dateValue || !timeValue || !tzValue) {\n      return null;\n    }\n\n    const tzNum = Number(tzValue);\n\n    const prettyTz = tzNum === 0 ? 'Z' : prettyOffset(tzNum);\n\n    const dateString = `${dateValue}T${timeValue}:00.000${prettyTz}`;\n\n    const finalDate = DateTime.fromISO(dateString);\n\n    if (makeDate) {\n      return finalDate;\n    }\n\n    return finalDate.toString();\n  }\n\n  function getRelativeExpiry(makeDate) {\n    const yearsElem = document.getElementById('relative-years');\n    const daysElem = document.getElementById('relative-days');\n    const hoursElem = document.getElementById('relative-hours');\n    const minutesElem = document.getElementById('relative-minutes');\n\n    if (yearsElem === null || daysElem === null || hoursElem === null || minutesElem === null) {\n      return null;\n    }\n\n    const years = Number(yearsElem.value ? yearsElem.value : '0');\n    const days = Number(daysElem.value ? daysElem.value : '0');\n    const hours = Number(hoursElem.value ? hoursElem.value : '0');\n    const minutes = Number(minutesElem.value ? minutesElem.value : '0');\n\n    if (isNaN(years) || isNaN(days) || isNaN(hours) || isNaN(minutes)) {\n      return null;\n    }\n\n    if (years + days + hours + minutes === 0) {\n      return null;\n    }\n\n    const date = DateTime.local().plus({\n      years,\n      days,\n      hours,\n      minutes,\n    });\n\n    if (makeDate) {\n      return date;\n    }\n\n    return date.toString();\n  }\n\n  /**\n   * @returns { null | String } date\n   */\n  function getExpiry() {\n    const expires = document.getElementById('expires');\n    if (expires === null) {\n      return null;\n    }\n\n    switch (expires.value) {\n      case 'relative':\n        return getRelativeExpiry(false);\n      case 'absolute':\n        return getAbsoluteExpiry(false);\n      default:\n        return null;\n    }\n  }\n\n  function setTimezone(tz) {\n    const tzSelect = document.getElementById('absolute-timezone');\n    if (tzSelect === null) {\n      return;\n    }\n\n    const offset = tz === undefined ? DateTime.local().offset / 60 : tz;\n    [...tzSelect.children].forEach(e => {\n      if (Number(e.value) === offset) {\n        e.setAttribute('selected', '');\n      } else {\n        e.removeAttribute('selected');\n      }\n    });\n  }\n\n  /**\n   * Create the upload array for handling multiple files.\n   *\n   * @returns {[{name: string, language: string, content: string}]} Array of upload files.\n   */\n  function createUpload() {\n    function getLanguage(parent) {\n      const lang = parent.querySelector('select[name=file_language]').value;\n      if (lang === '') {\n        return null;\n      }\n      return lang;\n    }\n\n    const files = [];\n    for (const editor of Object.values(pasteEditors)) {\n      const parent = editor.editorRoot.parentElement.parentElement.parentElement;\n      const file = {\n        'name': parent.querySelector('input[name=file_name]').value,\n        'language': getLanguage(parent),\n        'content': editor.getCode(),\n      };\n      const id = editor.editorRoot.parentElement.parentElement.parentElement.querySelector('input[name=id]');\n      if (id !== null) {\n        file.id = id.value;\n      }\n      files.push(file);\n    }\n    return files;\n  }\n\n  function highlight(pasteNum, input) {\n    // only use the websocket if it's connected\n    if (ws.readyState !== ws.OPEN) {\n      return document.createElement('pre');\n    }\n\n    // get the file for this editor\n    const file = pasteEditors[pasteNum].wrapper.parentElement.parentElement.parentElement;\n    // check to see if an override has been set\n    const override = file.querySelector('select[name=file_language]').value;\n    let name, type;\n    if (override === '') {\n      // if no override, use the file name for highlighting\n      name = file.querySelector('input[name=file_name]').value;\n      type = 'file';\n    } else {\n      // otherwise use the language name\n      name = override;\n      type = 'snippet';\n    }\n    // send a request for highlighting\n    // note that the websocket's message event handler will handle updating the highlighting\n    ws.send(`${pasteNum}\\n${name}\\n${type}\\n${input}`);\n\n    // return a new pre > code if none exists, otherwise use the existing one\n    const code = document.getElementById(`highlight-${pasteNum}`);\n\n    if (code === null) {\n      const newPre = document.createElement('pre');\n      const newCode = document.createElement('code');\n      newCode.id = `highlight-${pasteNum}`;\n      newPre.appendChild(newCode);\n      return newPre;\n    }\n\n    return code.parentElement;\n  }\n\n  /**\n   * Create an editor.\n   *\n   * @param {HTMLElement} parent The file container.\n   * @param {HTMLElement} el The element to convert into an editor.\n   */\n  function setUpEditor(parent, el) {\n    el.style.height = '400px';\n\n    // can't use arrow function because of `this`\n    const editor = new Editor(el, async function(input) {\n      return highlight(this.pasteNum, input);\n    });\n    editor.pasteNum = pasteNum;\n\n    const hidden = document.createElement('input');\n    hidden.type = 'hidden';\n    hidden.name = 'file_content';\n    hidden.id = 'hidden_content';\n    el.insertAdjacentElement('afterend', hidden);\n\n    const nameInput = parent.querySelector('input[name=file_name]');\n    const langInput = parent.querySelector('select[name=file_language]');\n\n    function updateLanguage() {\n      function getSuffixFromName(name) {\n        if (name === 'CMakeLists.txt') {\n          return 'CMake';\n        }\n\n        return name.split('.').pop();\n      }\n\n      let suffix;\n      if (langInput.value !== '') {\n        suffix = langInput.value;\n      } else if (nameInput.value !== '') {\n        suffix = getSuffixFromName(nameInput.value);\n      }\n      // const lang = hljs.getLanguage(suffix) !== undefined ? suffix : 'plaintext';\n      // editor.updateLanguage(lang);\n      // editor.updateCode(editor.code);\n    }\n\n    nameInput.addEventListener('input', updateLanguage);\n    langInput.addEventListener('change', updateLanguage);\n\n    // updateLanguage();\n    // editor.updateCode(el.value);\n    // editor.createLineNumbers(); // TODO: fix this in codesass\n\n    const toDelete = pasteNum;\n    parent\n      .querySelector('button[name=delete_button]')\n      .addEventListener('click', () => removeFile(toDelete));\n\n    pasteEditors[pasteNum] = editor;\n  }\n\n  function addFile() {\n    // get the base file for cloning (should be invisible if JS is running)\n    const base = document.getElementById('base_file');\n\n    // deep clone the base\n    const clone = base.cloneNode(true);\n\n    // show the editor by removing the requires-no-js class that was on the base\n    clone.classList.remove('requires-no-js');\n\n    pasteNum += 1;\n    clone.id = `file${pasteNum}`;\n\n    // set up an editor for each textarea in the base (should only be one)\n    for (const ta of clone.getElementsByTagName('textarea')) {\n      setUpEditor(clone, ta);\n    }\n\n    // add the editor to the dom\n    document.getElementById('end_of_files').insertAdjacentElement('beforebegin', clone);\n\n    updateButtons();\n  }\n\n  /**\n   * Remove a file. Will never remove the last file.\n   *\n   * @param {Number} num The number of the file to remove.\n   */\n  function removeFile(num) {\n    if (Object.keys(pasteEditors).length === 1) {\n      return;\n    }\n\n    const file = document.getElementById(`file${num}`);\n\n    if (file === null) {\n      return;\n    }\n\n    delete pasteEditors[num];\n\n    file.remove();\n\n    updateButtons();\n  }\n\n  function updateButtons() {\n    const enabled = Object.keys(pasteEditors).length > 1;\n    for (const button of document.getElementsByName('delete_button')) {\n      if (enabled) {\n        button.disabled = false;\n      } else {\n        button.disabled = true;\n      }\n    }\n  }\n\n  function createEditors() {\n    for (const editor of document.querySelectorAll('textarea.editor')) {\n      pasteNum += 1;\n      setUpEditor(editor.parentElement.parentElement.parentElement, editor);\n    }\n    updateButtons();\n  }\n\n  document.getElementById('add_file').addEventListener('click', addFile);\n\n  document.getElementById('paste_upload').addEventListener('submit', e => {\n    const input = document.createElement('input');\n    input.type = 'hidden';\n    input.value = JSON.stringify(createUpload());\n    input.name = 'upload_json';\n\n    e.target.appendChild(input);\n\n    const expiry = getExpiry();\n    if (expiry !== null) {\n      const expiresInput = document.createElement('input');\n      expiresInput.type = 'hidden';\n      expiresInput.value = expiry;\n      expiresInput.name = 'expires';\n\n      e.target.appendChild(expiresInput);\n    }\n  });\n\n  // create any initial editors\n  createEditors();\n\n  // add an initial file if necessary\n  if (Object.keys(pasteEditors).length === 0) {\n    addFile();\n  }\n\n  // set the default timezone\n  setTimezone();\n\n  (function() {\n    function inputsRequired(el, req) {\n      el.querySelectorAll('input, select').forEach(e => {\n        if (req) {\n          e.setAttribute('required', '');\n          return;\n        }\n        e.removeAttribute('required');\n      });\n    }\n\n    const expires = document.getElementById('expires');\n    if (expires === null) {\n      return;\n    }\n    expires.addEventListener('change', e => {\n      const expiry = e.target.value;\n      const abs = document.getElementById('absolute-expiry');\n      const rel = document.getElementById('relative-expiry');\n      if (expiry === 'relative') {\n        abs.classList.add('is-hidden');\n        rel.classList.remove('is-hidden');\n        inputsRequired(abs, false);\n        inputsRequired(rel, true);\n      } else if (expiry === 'absolute') {\n        abs.classList.remove('is-hidden');\n        rel.classList.add('is-hidden');\n        inputsRequired(abs, true);\n        inputsRequired(rel, false);\n      } else {\n        abs.classList.add('is-hidden');\n        rel.classList.add('is-hidden');\n        inputsRequired(abs, false);\n        inputsRequired(rel, false);\n      }\n    });\n  })();\n\n  (function() {\n    const abs = document.getElementById('absolute-expiry');\n    const expirationDate = abs.dataset.expirationDate;\n    if (expirationDate === undefined) {\n      return;\n    }\n\n    const date = DateTime.fromISO(expirationDate);\n\n    const year = date.year;\n    const month = date.month.toString().padStart(2, '0');\n    const day = date.day.toString().padStart(2, '0');\n    document.getElementById('absolute-date').value = `${year}-${month}-${day}`;\n\n    const hour = date.hour.toString().padStart(2, '0');\n    const minute = date.minute.toString().padStart(2, '0');\n    document.getElementById('absolute-time').value = `${hour}:${minute}`;\n\n    document.getElementById('absolute-timezone').value = `${date.offset / 60}`;\n  })();\n})();\n"],"file":"editor.js"}